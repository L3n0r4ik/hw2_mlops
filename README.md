# MLops Homework 1

Датасеты предоставлены в рамках соревнования https://www.kaggle.com/competitions/teta-ml-1-2025

Сервис для автоматического обнаружения мошеннических транзакций в режиме батчевого скоринга. Обрабатывает CSV-файлы из указанной директории с использованием предобученной CatBoost модели. 

## Архитектура решения
```
├── .gitignore
├── Dockerfile
├── README.md
├── app/
│ └── app.py # Ядро сервиса
│ └── artifatcs.py # Создает файлы с артефактами работы модели
│ └── preprocessing.py # Пайплайн обработки данных
│ └── scorer.py # Модуль прогнозирования
│ └── models/
│     └── catboost_model.cbm # Сериализованная модель CatBoost
└── input/ # Директория для загрузки файлов на скоринг
└── output/ # Директория с результатами скоринга
```

## Ключевые особенности

### Многоуровневое логирование
- Консольный вывод для мониторинга в реальном времени
- Уровнень детализации:
  - `INFO`: Основные этапы обработки

### Пайплайн обработки данных (`preprocessing.py`)
1. **Временные признаки**:
   - Извлечение часа, дня недели, дня, месяца
   
2. **Геопространственные расчеты**:
   - Расчет расстояния (км) между клиентом и мерчантом

3. **Категориальные переменные**:
   - Импутация 'missing' значениями

4. **Числовые признаки**:
   - Импутация средними значениями

### Модельный слой (`scorer.py`)
- Автоматическая загрузка модели при инициализации
- Предсказание через `predict_proba`

### Артефактный слой (`artifacts.py`)
- Сохраняет артефакты от работы модели: 
   - json-файл с топ-5 feature importances используемой модели, где key – название фичи, value – значение фичи.
	- png-файл с графиком плотности распределения предсказанных моделью скоров


## Быстрый старт

### Требования
- Docker 20.10+
- 2 ГБ свободного места
- Порты: только файловая система

### Запуск сервиса

1. Соберите образ
```bash
docker build -t mlops_hw1 .
```
3. Запустите контейнер с монтированием томов
```bash
docker run --rm   -v $(pwd)/input:/app/input   -v $(pwd)/output:/app/output   mlops_hw1
```
4. После запуска сервиса:
 - В логах появляется информация о загрузке test.csv файла, генерации submission, загрузке модели, сохранения предсказаний, артефактов в папку output